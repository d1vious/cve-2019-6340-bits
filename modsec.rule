# CVE-2019-6340
SecRule REQUEST_URI "@rx ^/node/\d+\?_format=hal_json"  \
   "id:932200,\
    phase:2,\
    block,\
    deny,\
    msg:'CVE-2019-6340 Drupal Restful module RCE',\
    logdata:'Matched Data: CVE-2019-6340 Drupal Restful module RCE found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
    tag:'application-multi',\
    tag:'language-php',\
    tag:'attack-rce',\
    tag:'OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION',\
    tag:'WASCTC/WASC-31',\
    tag:'OWASP_TOP_10/A1',\
    tag:'PCI/6.5.2',\
    severity:'CRITICAL',\
    chain"
    SecRule REQUEST_BODY "GuzzleHttp\\\\HandlerStack" \
	"capture,\
    	setvar:'tx.rce_score=+%{tx.critical_anomaly_score}',\
	   	setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',\
	   	setvar:'tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/RCE-%{MATCHED_VAR_NAME}=%{tx.0}',\
	   	setvar:'tx.msg=%{rule.msg}'"
